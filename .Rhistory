library(stargazer)
library(jtools)
plot_summs(modelo,scale = TRUE)
inputData = data[,c(1,3:7)]
row.names(inputData) = inputData$codigo
inputData = inputData[,-c(1)]
Data_clusters = daisy(inputData, metric="gower")
fviz_nbclust(inputData, pam,diss=Data_clusters,method = "gap_stat",k.max = 10,verbose = F) #Nos recomienda 2
set.seed(123)
res.pam=pam(Data_clusters,2,cluster.only = F)
#nueva columna
inputData$pam=res.pam$cluster
fviz_silhouette(res.pam,print.summary = F)
res.agnes<- hcut(Data_clusters, k = 2,hc_func='agnes',hc_method = "ward.D")
inputData$agnes=res.agnes$cluster
fviz_silhouette(res.agnes,print.summary = F)
set.seed(123)
res.diana <- hcut(Data_clusters, k = 2,hc_func='diana')
inputData$diana=res.diana$cluster
fviz_silhouette(res.diana,print.summary = F)
View(inputData)
data$dianapoor=data$codigo%in%poorDIANA
data$dianapoor=data$codigo
data$diana=as.ordered(inputData$diana)
inputData$diana=NULL
View(data)
data = merge(data, inputData, by = "dianapoor")
data$codigo=data$codigo
data$diana=as.ordered(inputData$diana)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("logoPUCP.png")
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
#Librerías del ejercicio:.
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
library(magrittr)
data%>%
rmarkdown::paged_table()
str(data)
library(stringi)
names(data)=stri_trans_general(str = names(data),
id = "Latin-ASCII")
datatable(data, filter = "top")
Dependiente = data[,c(1,3)]
colnames(Dependiente)[2] = "Proporción de escaños parlamentarios ocupados por mujeres"
datatable(Dependiente, filter = "top")
library(sf)
mapWLD=sf::read_sf("world-administrative-boundaries.shp")
head(mapWLD)
mapMUN=merge(mapWLD,data,by.x='iso3',by.y='codigo', all.x = T)
head(mapMUN)
library(ggplot2)
mapaleyendaL= ggplot(mapMUN)+ geom_sf() + theme_light()
mapaleyL= mapaleyendaL + geom_sf(data=mapMUN,
aes(fill=parlamentos2020),color = NA)
mapa3= mapaleyL +
coord_sf() +
scale_fill_gradient(low = "#FDFEFE",  high = "red", breaks=seq(from=0, to=61.25, by=20)) + theme_void() +
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(0.16,0.1)) + labs(fill="Escaños parlamentarios mujeres") + theme(legend.text = element_text(size = 10)) +
labs(title = "Distribución de la proporción de escaños parlamentarios ocupados por mujeres en cada país", subtitle = "Escala del 0 al 100") +
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))
mapa3
parlamentomuj = data[,c(1,3)]
parlamentomuj_summary = as.data.frame(apply(parlamentomuj[-1],2,summary))
parlamentomuj_summary%>%
kbl() %>%
kable_minimal()
parlamentomuj = melt(parlamentomuj, id=c("codigo"))
ggplot(data= parlamentomuj, aes(x=value, group=variable, fill=variable)) +
geom_density(adjust=1.5, alpha=.4, color = "black", linetype = "dashed") +
scale_fill_manual(values=c("firebrick","dodgerblue2"), name = "")  +
theme(legend.position="bottom") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank())  +
labs(title = "Concentración de países acorde a la presencia femenina en los escaños parlamentarios",
x = " ",
y = " ")
modelo = lm(parlamentos2020 ~ Por_Vulnerable_Femenino_2015 + Poblacion_Act_Mujeres2015 + Gasto_public_educacion_2015 + PBI_2015, data = data)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
modelsummary(modelo, title = "OLS",
stars = TRUE,
output = "kableExtra")
library(stargazer)
library(jtools)
plot_summs(modelo,scale = TRUE)
inputData = data[,c(1,3:7)]
row.names(inputData) = inputData$codigo
inputData = inputData[,-c(1)]
Data_clusters = daisy(inputData, metric="gower")
fviz_nbclust(inputData, pam,diss=Data_clusters,method = "gap_stat",k.max = 10,verbose = F) #Nos recomienda 2
set.seed(123)
res.pam=pam(Data_clusters,2,cluster.only = F)
#nueva columna
inputData$pam=res.pam$cluster
fviz_silhouette(res.pam,print.summary = F)
res.agnes<- hcut(Data_clusters, k = 2,hc_func='agnes',hc_method = "ward.D")
inputData$agnes=res.agnes$cluster
fviz_silhouette(res.agnes,print.summary = F)
set.seed(123)
res.diana <- hcut(Data_clusters, k = 2,hc_func='diana')
inputData$diana=res.diana$cluster
fviz_silhouette(res.diana,print.summary = F)
#Agregamos conglomerados:
inputData$clust = factor(res.diana$cluster)
View(res.diana)
View(inputData)
View(data)
data$dianapoor=data$codigo%in%poorDIANA
data$dianapoor=data$codigo%in%inputData
data$diana=as.ordered(inputData$diana)
inputData$diana=NULL
View(data)
data$diana = factor(data$diana, levels = c(1:2), labels = c("Presencia alta de mujeres","Presencia baja de mujeres"))
data$dianapoor=data$codigo%in%inputData
data$diana=as.ordered(inputData$diana)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("logoPUCP.png")
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
#Librerías del ejercicio:.
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
library(magrittr)
data%>%
rmarkdown::paged_table()
str(data)
library(stringi)
names(data)=stri_trans_general(str = names(data),
id = "Latin-ASCII")
datatable(data, filter = "top")
Dependiente = data[,c(1,3)]
colnames(Dependiente)[2] = "Proporción de escaños parlamentarios ocupados por mujeres"
datatable(Dependiente, filter = "top")
library(sf)
mapWLD=sf::read_sf("world-administrative-boundaries.shp")
head(mapWLD)
mapMUN=merge(mapWLD,data,by.x='iso3',by.y='codigo', all.x = T)
head(mapMUN)
library(ggplot2)
mapaleyendaL= ggplot(mapMUN)+ geom_sf() + theme_light()
mapaleyL= mapaleyendaL + geom_sf(data=mapMUN,
aes(fill=parlamentos2020),color = NA)
mapa3= mapaleyL +
coord_sf() +
scale_fill_gradient(low = "#FDFEFE",  high = "red", breaks=seq(from=0, to=61.25, by=20)) + theme_void() +
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(0.16,0.1)) + labs(fill="Escaños parlamentarios mujeres") + theme(legend.text = element_text(size = 10)) +
labs(title = "Distribución de la proporción de escaños parlamentarios ocupados por mujeres en cada país", subtitle = "Escala del 0 al 100") +
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))
mapa3
parlamentomuj = data[,c(1,3)]
parlamentomuj_summary = as.data.frame(apply(parlamentomuj[-1],2,summary))
parlamentomuj_summary%>%
kbl() %>%
kable_minimal()
parlamentomuj = melt(parlamentomuj, id=c("codigo"))
ggplot(data= parlamentomuj, aes(x=value, group=variable, fill=variable)) +
geom_density(adjust=1.5, alpha=.4, color = "black", linetype = "dashed") +
scale_fill_manual(values=c("firebrick","dodgerblue2"), name = "")  +
theme(legend.position="bottom") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank())  +
labs(title = "Concentración de países acorde a la presencia femenina en los escaños parlamentarios",
x = " ",
y = " ")
modelo = lm(parlamentos2020 ~ Por_Vulnerable_Femenino_2015 + Poblacion_Act_Mujeres2015 + Gasto_public_educacion_2015 + PBI_2015, data = data)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
modelsummary(modelo, title = "OLS",
stars = TRUE,
output = "kableExtra")
library(stargazer)
library(jtools)
plot_summs(modelo,scale = TRUE)
inputData = data[,c(1,3:7)]
row.names(inputData) = inputData$codigo
inputData = inputData[,-c(1)]
Data_clusters = daisy(inputData, metric="gower")
fviz_nbclust(inputData, pam,diss=Data_clusters,method = "gap_stat",k.max = 10,verbose = F) #Nos recomienda 2
set.seed(123)
res.pam=pam(Data_clusters,2,cluster.only = F)
#nueva columna
inputData$pam=res.pam$cluster
fviz_silhouette(res.pam,print.summary = F)
res.agnes<- hcut(Data_clusters, k = 2,hc_func='agnes',hc_method = "ward.D")
inputData$agnes=res.agnes$cluster
fviz_silhouette(res.agnes,print.summary = F)
set.seed(123)
res.diana <- hcut(Data_clusters, k = 2,hc_func='diana')
inputData$diana=res.diana$cluster
fviz_silhouette(res.diana,print.summary = F)
#Agregamos conglomerados:
inputData$clust = factor(res.diana$cluster)
data$codigo=data$codigo%in%inputData
data$diana=as.ordered(inputData$diana)
inputData$diana=NULL
View(data)
View(data)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("logoPUCP.png")
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
#Librerías del ejercicio:.
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
library(magrittr)
data%>%
rmarkdown::paged_table()
str(data)
library(stringi)
names(data)=stri_trans_general(str = names(data),
id = "Latin-ASCII")
datatable(data, filter = "top")
Dependiente = data[,c(1,3)]
colnames(Dependiente)[2] = "Proporción de escaños parlamentarios ocupados por mujeres"
datatable(Dependiente, filter = "top")
library(sf)
mapWLD=sf::read_sf("world-administrative-boundaries.shp")
head(mapWLD)
mapMUN=merge(mapWLD,data,by.x='iso3',by.y='codigo', all.x = T)
head(mapMUN)
library(ggplot2)
mapaleyendaL= ggplot(mapMUN)+ geom_sf() + theme_light()
mapaleyL= mapaleyendaL + geom_sf(data=mapMUN,
aes(fill=parlamentos2020),color = NA)
mapa3= mapaleyL +
coord_sf() +
scale_fill_gradient(low = "#FDFEFE",  high = "red", breaks=seq(from=0, to=61.25, by=20)) + theme_void() +
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(0.16,0.1)) + labs(fill="Escaños parlamentarios mujeres") + theme(legend.text = element_text(size = 10)) +
labs(title = "Distribución de la proporción de escaños parlamentarios ocupados por mujeres en cada país", subtitle = "Escala del 0 al 100") +
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))
mapa3
parlamentomuj = data[,c(1,3)]
parlamentomuj_summary = as.data.frame(apply(parlamentomuj[-1],2,summary))
parlamentomuj_summary%>%
kbl() %>%
kable_minimal()
parlamentomuj = melt(parlamentomuj, id=c("codigo"))
ggplot(data= parlamentomuj, aes(x=value, group=variable, fill=variable)) +
geom_density(adjust=1.5, alpha=.4, color = "black", linetype = "dashed") +
scale_fill_manual(values=c("firebrick","dodgerblue2"), name = "")  +
theme(legend.position="bottom") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank())  +
labs(title = "Concentración de países acorde a la presencia femenina en los escaños parlamentarios",
x = " ",
y = " ")
modelo = lm(parlamentos2020 ~ Por_Vulnerable_Femenino_2015 + Poblacion_Act_Mujeres2015 + Gasto_public_educacion_2015 + PBI_2015, data = data)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
modelsummary(modelo, title = "OLS",
stars = TRUE,
output = "kableExtra")
library(stargazer)
library(jtools)
plot_summs(modelo,scale = TRUE)
inputData = data[,c(1,3:7)]
row.names(inputData) = inputData$codigo
inputData = inputData[,-c(1)]
Data_clusters = daisy(inputData, metric="gower")
fviz_nbclust(inputData, pam,diss=Data_clusters,method = "gap_stat",k.max = 10,verbose = F) #Nos recomienda 2
set.seed(123)
res.pam=pam(Data_clusters,2,cluster.only = F)
#nueva columna
inputData$pam=res.pam$cluster
fviz_silhouette(res.pam,print.summary = F)
res.agnes<- hcut(Data_clusters, k = 2,hc_func='agnes',hc_method = "ward.D")
inputData$agnes=res.agnes$cluster
fviz_silhouette(res.agnes,print.summary = F)
set.seed(123)
res.diana <- hcut(Data_clusters, k = 2,hc_func='diana')
inputData$diana=res.diana$cluster
fviz_silhouette(res.diana,print.summary = F)
#Agregamos conglomerados:
inputData$clust = factor(res.diana$cluster)
View(inputData)
View(data)
#Lo pasamos a la data original:
inputData$codigo = row.names(inputData)
row.names(inputData) = NULL
inputData = inputData[,c(8,9)]
View(inputData)
data = merge(data, inputData, by = "DISTRITO")
data = merge(data, inputData, by = "codigo")
inputData = inputData[,c(9)]
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("logoPUCP.png")
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
#Librerías del ejercicio:.
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
library(magrittr)
data%>%
rmarkdown::paged_table()
str(data)
library(stringi)
names(data)=stri_trans_general(str = names(data),
id = "Latin-ASCII")
datatable(data, filter = "top")
Dependiente = data[,c(1,3)]
colnames(Dependiente)[2] = "Proporción de escaños parlamentarios ocupados por mujeres"
datatable(Dependiente, filter = "top")
library(sf)
mapWLD=sf::read_sf("world-administrative-boundaries.shp")
head(mapWLD)
mapMUN=merge(mapWLD,data,by.x='iso3',by.y='codigo', all.x = T)
head(mapMUN)
library(ggplot2)
mapaleyendaL= ggplot(mapMUN)+ geom_sf() + theme_light()
mapaleyL= mapaleyendaL + geom_sf(data=mapMUN,
aes(fill=parlamentos2020),color = NA)
mapa3= mapaleyL +
coord_sf() +
scale_fill_gradient(low = "#FDFEFE",  high = "red", breaks=seq(from=0, to=61.25, by=20)) + theme_void() +
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(0.16,0.1)) + labs(fill="Escaños parlamentarios mujeres") + theme(legend.text = element_text(size = 10)) +
labs(title = "Distribución de la proporción de escaños parlamentarios ocupados por mujeres en cada país", subtitle = "Escala del 0 al 100") +
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))
mapa3
parlamentomuj = data[,c(1,3)]
parlamentomuj_summary = as.data.frame(apply(parlamentomuj[-1],2,summary))
parlamentomuj_summary%>%
kbl() %>%
kable_minimal()
parlamentomuj = melt(parlamentomuj, id=c("codigo"))
ggplot(data= parlamentomuj, aes(x=value, group=variable, fill=variable)) +
geom_density(adjust=1.5, alpha=.4, color = "black", linetype = "dashed") +
scale_fill_manual(values=c("firebrick","dodgerblue2"), name = "")  +
theme(legend.position="bottom") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank())  +
labs(title = "Concentración de países acorde a la presencia femenina en los escaños parlamentarios",
x = " ",
y = " ")
modelo = lm(parlamentos2020 ~ Por_Vulnerable_Femenino_2015 + Poblacion_Act_Mujeres2015 + Gasto_public_educacion_2015 + PBI_2015, data = data)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
modelsummary(modelo, title = "OLS",
stars = TRUE,
output = "kableExtra")
library(stargazer)
library(jtools)
plot_summs(modelo,scale = TRUE)
inputData = data[,c(1,3:7)]
row.names(inputData) = inputData$codigo
inputData = inputData[,-c(1)]
Data_clusters = daisy(inputData, metric="gower")
fviz_nbclust(inputData, pam,diss=Data_clusters,method = "gap_stat",k.max = 10,verbose = F) #Nos recomienda 2
set.seed(123)
res.pam=pam(Data_clusters,2,cluster.only = F)
#nueva columna
inputData$pam=res.pam$cluster
fviz_silhouette(res.pam,print.summary = F)
res.agnes<- hcut(Data_clusters, k = 2,hc_func='agnes',hc_method = "ward.D")
inputData$agnes=res.agnes$cluster
fviz_silhouette(res.agnes,print.summary = F)
set.seed(123)
res.diana <- hcut(Data_clusters, k = 2,hc_func='diana')
inputData$diana=res.diana$cluster
fviz_silhouette(res.diana,print.summary = F)
#Agregamos conglomerados:
inputData$clust = factor(res.diana$cluster)
#Lo pasamos a la data original:
inputData$codigo = row.names(inputData)
row.names(inputData) = NULL
inputData = inputData[,c(9)]
data = merge(data, inputData, by = "codigo")
View(data)
#Lo pasamos a la data original:
inputData$codigo = row.names(inputData)
row.names(inputData) = NULL
inputData = inputData[,c(9)]
View(inputData)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("logoPUCP.png")
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
#Librerías del ejercicio:.
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
gitLink="https://raw.githubusercontent.com/XiomaraOshik/Est_2/main/data.csv"
data=rio::import(gitLink)
library(magrittr)
data%>%
rmarkdown::paged_table()
str(data)
library(stringi)
names(data)=stri_trans_general(str = names(data),
id = "Latin-ASCII")
datatable(data, filter = "top")
Dependiente = data[,c(1,3)]
colnames(Dependiente)[2] = "Proporción de escaños parlamentarios ocupados por mujeres"
datatable(Dependiente, filter = "top")
library(sf)
mapWLD=sf::read_sf("world-administrative-boundaries.shp")
head(mapWLD)
mapMUN=merge(mapWLD,data,by.x='iso3',by.y='codigo', all.x = T)
head(mapMUN)
library(ggplot2)
mapaleyendaL= ggplot(mapMUN)+ geom_sf() + theme_light()
mapaleyL= mapaleyendaL + geom_sf(data=mapMUN,
aes(fill=parlamentos2020),color = NA)
mapa3= mapaleyL +
coord_sf() +
scale_fill_gradient(low = "#FDFEFE",  high = "red", breaks=seq(from=0, to=61.25, by=20)) + theme_void() +
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(0.16,0.1)) + labs(fill="Escaños parlamentarios mujeres") + theme(legend.text = element_text(size = 10)) +
labs(title = "Distribución de la proporción de escaños parlamentarios ocupados por mujeres en cada país", subtitle = "Escala del 0 al 100") +
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))
mapa3
parlamentomuj = data[,c(1,3)]
parlamentomuj_summary = as.data.frame(apply(parlamentomuj[-1],2,summary))
parlamentomuj_summary%>%
kbl() %>%
kable_minimal()
parlamentomuj = melt(parlamentomuj, id=c("codigo"))
ggplot(data= parlamentomuj, aes(x=value, group=variable, fill=variable)) +
geom_density(adjust=1.5, alpha=.4, color = "black", linetype = "dashed") +
scale_fill_manual(values=c("firebrick","dodgerblue2"), name = "")  +
theme(legend.position="bottom") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank())  +
labs(title = "Concentración de países acorde a la presencia femenina en los escaños parlamentarios",
x = " ",
y = " ")
modelo = lm(parlamentos2020 ~ Por_Vulnerable_Femenino_2015 + Poblacion_Act_Mujeres2015 + Gasto_public_educacion_2015 + PBI_2015, data = data)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
modelsummary(modelo, title = "OLS",
stars = TRUE,
output = "kableExtra")
library(stargazer)
library(jtools)
plot_summs(modelo,scale = TRUE)
inputData = data[,c(1,3:7)]
row.names(inputData) = inputData$codigo
inputData = inputData[,-c(1)]
Data_clusters = daisy(inputData, metric="gower")
fviz_nbclust(inputData, pam,diss=Data_clusters,method = "gap_stat",k.max = 10,verbose = F) #Nos recomienda 2
set.seed(123)
res.pam=pam(Data_clusters,2,cluster.only = F)
#nueva columna
inputData$pam=res.pam$cluster
fviz_silhouette(res.pam,print.summary = F)
res.agnes<- hcut(Data_clusters, k = 2,hc_func='agnes',hc_method = "ward.D")
inputData$agnes=res.agnes$cluster
fviz_silhouette(res.agnes,print.summary = F)
set.seed(123)
res.diana <- hcut(Data_clusters, k = 2,hc_func='diana')
inputData$diana=res.diana$cluster
fviz_silhouette(res.diana,print.summary = F)
#Agregamos conglomerados:
inputData$clust = factor(res.diana$cluster)
View(inputData)
#Lo pasamos a la data original:
inputData$codigo = row.names(inputData)
row.names(inputData) = NULL
inputData = inputData[,c(8)]
data = merge(data, inputData, by = "codigo")
